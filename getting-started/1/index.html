<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>1. Run your first application - Kubernetes Camp</title>
<meta name="description" content="Learn Kubernetes on your Coffee Break">
<meta name="generator" content="Hugo 0.56.3" />
<link href="https://k8s.camp/index.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://k8s.camp/getting-started/1/">
<link rel="stylesheet" href="https://k8s.camp/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://k8s.camp/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://k8s.camp/js/functions.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<script src="https://k8s.camp/js/jquery.backtothetop/jquery.backtothetop.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-35638296-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-35638296-2');
</script>
</head>
<body>
<div class="container"><header>
<h1>Kubernetes Camp</h1>
<a href="https://github.com/paulczar/k8s-camp" class="github"><i class="fab fa-github"></i></a>
<p class="description">Learn Kubernetes on your Coffee Break</p>

</header>

<div class="content-container">
<main><h1>1. Run your first application</h1>

<p>Above all else <a href="https://kubernetes.io">Kubernetes</a> is a platform for running applications. It takes applications in the form of <a href="/glossary/#container">Linux Containers</a> and runs them in a special executable environment called a <a href="/glossary/#pod">Pod</a>.</p>

<p>A simple application such as NGINX can deploy to Kubernetes with a simple <code>kubectl</code> command. While this is not how you would deploy software into production, its a nice easy way to start getting familiar with Kubernetes.</p>

<h2 id="do">Do</h2>

<h3 id="ask-kubernetes-to-run-nginx">Ask Kubernetes to run NGINX</h3>

<p>You can use the <code>kubectl create</code> command to create a <a href="/glossary/#deployment">Deployment</a> which is a <a href="/glossary/#controller">Controller</a> that wraps around a <a href="/glossary/#pod">Pod</a> to provide functionality.</p>

<blockquote>
<p>Note: Kubernetes downloads images from an Image Registry, if a specific registry is not provided it will default to the public Docker Registry. Thus the image referenced below is pulled from <a href="https://hub.docker.com/_/nginx">https://hub.docker.com/_/nginx</a>.</p>
</blockquote>

<pre><code class="language-console">$ kubectl create deployment first --image=nginx
deployment.apps/first created
</code></pre>

<h3 id="look-at-what-resources-are-running">Look at what resources are running</h3>

<blockquote>
<p>Note there are actually three resources deployed as a result of this command. <code>kubectl create deployment</code> created the <a href="/glossary/#deployment">Deployment</a>, which created the <a href="/glossary/#replicaset">ReplicaSet</a>, which created the <a href="/glossary/#pod">Pod</a> in which the application itself is running.</p>
</blockquote>

<pre><code class="language-console">$ kubectl get all
NAME                    READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/first   1/1     1            1           15h

NAME                               DESIRED   CURRENT   READY   AGE
replicaset.apps/first-7f77d57ccc   1         1         1       15h

NAME                         READY   STATUS    RESTARTS   AGE
pod/first-7f77d57ccc-8gwkp   1/1     Running   0          15h
</code></pre>

<h3 id="ask-kubernetes-to-forward-a-port-to-your-new-deployment">Ask Kubernetes to forward a port to your new deployment</h3>

<p>The astute observer would notice that there&rsquo;s no obvious way to access your application in the above output. This is because a <a href="/glossary/#service">Service</a> is needed to wire up external access.</p>

<p>You can access an application by using the <code>kubectl port-forward</code> command which will forward a port from your localhost into the specified Resource.</p>

<blockquote>
<p>Note: this process will run until you hit <code>ctrl-c</code> to break it.</p>
</blockquote>

<pre><code class="language-console">$ kubectl port-forward deployment/first 8080:80
Forwarding from 127.0.0.1:8080 -&gt; 80
Handling connection for 8080
</code></pre>

<p>Access <a href="http://127.0.0.1:8080">http://127.0.0.1:8080</a> from a web browser, or another terminal:</p>

<pre><code class="language-console">$ curl 127.0.0.1:8080
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h2 id="learn">Learn</h2>

<h3 id="summary">Summary</h3>

<p>What you just did was create a Kubernetes resource using the <strong><a href="/glossary/#imperative">imperative</a></strong> command <code>kubectl create deployment</code>. This creates a <strong><a href="/glossary/#deployment">Deployment</a></strong> resource which in turn creates a <strong><a href="/glossary/#replicaset">ReplicaSet</a></strong> resource which in turn creates a <strong><a href="/glossary/#pod">Pod</a></strong> resource.</p>

<blockquote>
<p>Imperative commands are actions that act against the live resources and are used to quickly create, update, and delete resources. While this makes for simple use, they are not great for real workloads.</p>
</blockquote>

<h3 id="controllers">Controllers</h3>

<p>Controllers are the beating heart of Kubernetes, they&rsquo;re what take it from being a fairly simple container scheduler to a powerful platform. Controllers are programs that watch resources (by connecting to the API) and reconciles the live object against the desired state.</p>

<p>Most resources in Kubernetes are managed by controllers. Following the <a href="https://en.wikipedia.org/wiki/Unix_philosophy">UNIX Philosophy</a> of doing one thing and doing it well, controllers will often stack together to create complex workflows.</p>

<p>We saw this controller stacking in action above when we created a Deployment, which managed ReplicaSets which in turn managed sets of Pods.</p>

<h3 id="resources">Resources</h3>

<p>Kubernetes objects are known as Resources and they can be described by a fairly simple data structure, usually formatted as <em>YAML</em> or <em>JSON</em>. All resources have a <em>kind</em>, <em>apiVersion</em>, <em>metadata</em>, and <em>spec</em>.</p>

<h4 id="pod">Pod</h4>

<p>A Pod is the basic building block of compute operations in Kubernetes. A Pod is <em>not</em> a container, a Pod is the execution environment in which one or more containers run. Each pod shares a Network IP (and localhost) and Volumes between the Containers hosted in the pod.</p>

<p>Think of the Pod as the minimum scalable unit of your application. If you were running Wordpress you might run an NGINX container and a PHP-FPM container in the same pod sharing a UNIX socket over a shared volume. You would not however put the MySQL database in the same pod as while it is part of your application it is a separate scalable unit of your application.</p>

<p>A Pod however is [purposefully] quite fragile. A Pod is scheduled to a specific worker node (managed via the kubelet process). If the worker node disappears, so does the pod.</p>

<h4 id="replicaset">ReplicaSet</h4>

<p>The ReplicaSet improves the resiliency of compute workloads on Kubernetes. A ReplicaSet Controller manages multiple copies of the same Pod. When the ReplicaSet controller detects that the number of pods is different to the requested number of Pods it will attempt to create or destroy pods to reconcile the difference.</p>

<p>It is completely normal to see a ReplicaSet with a size of one, as that ensures that if a Pod disappears a new copy of the pod will be started.</p>

<h4 id="deployment">Deployment</h4>

<p>A Deployment goes one step further and manages the upgrade lifecycle of a compute workload on Kubernetes. A Deployment Controller manages sets of ReplicaSet resources. When you first request a Deployment the controller will request a single ReplicaSet of the specified size.</p>

<p>When you change the image version, change an environment variable, or other such settings the Deployment Controller goes to work. It will request a new ReplicaSet using the new settings and will slowly increase the new ReplicaSet size while reducing the old ReplicaSet (maintaining the correct max count) until the old ReplicaSet has a size of zero.</p>

<p>You can tweak the specific behaviors of the upgrade process in the Deployment resource manifest.</p>

<p><a href="/getting-started/2">Next</a> learn how to scale and upgrade your Application.</p>
<div class="edit-meta">

<br></div><nav class="pagination"><a class="nav nav-prev" href="/getting-started/" title="Getting Started"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - Getting Started</a>
<a class="nav nav-next" href="/getting-started/2/" title="2. Scale and upgrade your application">Next - 2. Scale and upgrade your application <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">
<nav>
<ul>
<li class=""><a href="https://k8s.camp/">Home</a></li>

<li class="parent"><a href="/getting-started/">Getting Started</a>
<ul class="sub-menu">
<li class="active"><a href="/getting-started/1/">1. Run your first application</a></li>
<li class=""><a href="/getting-started/2/">2. Scale and upgrade your application</a></li>
<li class=""><a href="/getting-started/3/">3. Accessing your application</a></li>
<li class=""><a href="/getting-started/4/">4. Configuring your Application</a></li>
</ul>
  
</li>

<li class=""><a href="/glossary/">Glossary</a>
</li>

<li class=""><a href="/running-kubernetes/">Running Kubernetes</a>
<ul class="">
<li class=""><a href="/running-kubernetes/kind/">Running Kubernetes - KIND</a></li>
<li class=""><a href="/running-kubernetes/minikube/">Running Kubernetes - Minikube</a></li>
</ul>
  
</li>
</ul>
</nav>


<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
